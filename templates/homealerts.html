{% extends "nav.html" %}

{% block title %}Home Alerts{% endblock %}

{% block content %}

<style>
     body {
            background-color: #121212;
            color: #fff;
        }
     .alert-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #1e1e1e;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        .alert-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border-bottom: 1px solid #333;
        }
        .alert-item:last-child {
            border-bottom: none;
        }
        .alert-info {
            display: flex;
            align-items: center;
        }
        .alert-icon {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 15px;
        }
        .alert-time {
            font-size: 0.9em;
            color: #aaa;
        }
        .red { background-color: red; }
        .yellow { background-color: yellow; }
        .green { background-color: green; }
</style>
<div class="alert-container">
    <div class="alert-item">
        <div class="alert-info"><span class="alert-icon red"></span> Possible fire detected</div>
        <div class="alert-time">12:30 PM</div>
    </div>
    <div class="alert-item">
        <div class="alert-info"><span class="alert-icon yellow"></span> Possible intrusion</div>
        <div class="alert-time">12:25 PM</div>
    </div>
    <div class="alert-item">
        <div class="alert-info"><span class="alert-icon green"></span> Door opened for &lt;name&gt;</div>
        <div class="alert-time">12:15 PM</div>
    </div>
    <div class="alert-item">
        <div class="alert-info"><span class="alert-icon yellow"></span> Too many consecutive incorrect attempts for fingerprint</div>
        <div class="alert-time">12:10 PM</div>
    </div>
    <div class="alert-item">
        <div class="alert-info"><span class="alert-icon yellow"></span> Possible Camera_1 obstruction</div>
        <div class="alert-time">12:05 PM</div>
    </div>
</div>

<script>
    function fetchAlerts() {
        fetch('/get_alerts')
        .then(response => response.json())
        .then(data => {
            let container = document.querySelector('.alert-container');
            container.innerHTML = ''; // Uncomment this to clear previous alerts if needed

            data.forEach(alert => {
                let colorClass = alert.type === 'temperature' ? 'red' : 'yellow';
                let alertItem = `
                    <div class="alert-item">
                        <div class="alert-info">
                            <span class="alert-icon ${colorClass}"></span> ${alert.message}
                        </div>
                        <div class="alert-time">${alert.timestamp}</div>
                    </div>
                `;
                container.innerHTML += alertItem;
            });
        });
    }

    fetchAlerts();
    setInterval(fetchAlerts, 10000);
</script>
{% endblock %}
